<script>

// =====================
// SPIELE LISTE (DEIN ORIGINAL + TESTSPIEL)
// =====================

const games = [

{ id:999, title:"Ultimate Car Driving Simulator", category:"racing", emoji:"üöó", description:"Car Driving Simulator", plays:9999, rating:4.8, trending:true, new:true, url:"https://www.madkidgames.com/full/ultimate-car-driving-simulator" },

// üëâ HIER DEINE GANZE ALTE LISTE WEITER (nichts l√∂schen)
{ id:1,title:'Gun Master',category:'weapons',emoji:'üî´',description:'Meistere alle Waffen!',plays:24500,rating:4.8,trending:true,new:false },

// usw... (deine komplette Liste bleibt einfach stehen)

];

let currentUser=null;
let userRatings={};
let userFavorites=[];
let filteredGames=[...games];

const authBtn=document.getElementById('authBtn');
const authModal=document.getElementById('authModal');
const gameModal=document.getElementById('gameModal');
const loginBtn=document.getElementById('loginBtn');
const logoutBtn=document.getElementById('logoutBtn');
const searchInput=document.getElementById('searchInput');
const gamesContainer=document.getElementById('gamesContainer');
const trendingContainer=document.getElementById('trendingContainer');
const newGamesContainer=document.getElementById('newGamesContainer');
const categoryFilters=document.querySelectorAll('.category-filter');
const sortFilter=document.getElementById('sortFilter');
const resetFilters=document.getElementById('resetFilters');
const userProfile=document.getElementById('userProfile');
const userName=document.getElementById('userName');
const gameCount=document.getElementById('gameCount');

document.addEventListener('DOMContentLoaded',()=>{
loadUserData();
renderAllGames();
setupEventListeners();
});

function setupEventListeners(){

authBtn.addEventListener('click',()=>{if(currentUser)logoutUser();else openAuthModal();});
loginBtn.addEventListener('click',loginUser);
logoutBtn.addEventListener('click',logoutUser);

searchInput.addEventListener('input',filterGames);
categoryFilters.forEach(filter=>filter.addEventListener('change',filterGames));
sortFilter.addEventListener('change',filterGames);
resetFilters.addEventListener('click',resetAllFilters);

document.querySelectorAll('.close-btn').forEach(closeBtn=>{
closeBtn.addEventListener('click',(e)=>{
e.target.closest('.modal').style.display='none';
});
});

}

function showGameDetail(game){

// ‚≠ê PRO FEATURE: wenn URL vorhanden ‚Üí iframe starten
if(game.url){

document.getElementById('gameDetail').innerHTML=`
<iframe src="${game.url}" width="100%" height="600px" frameborder="0" allowfullscreen></iframe>
`;

gameModal.style.display='block';
return;

}

// sonst normales Detail
alert(game.title);

}

function renderAllGames(){

const trendingGames=games.filter(g=>g.trending).slice(0,8);
renderGames(trendingGames,trendingContainer,true);

const newGames=games.filter(g=>g.new).slice(0,8);
renderGames(newGames,newGamesContainer);

filterGames();

}

function renderGames(gamesToRender,container,isTrending=false){

container.innerHTML='';

gamesToRender.forEach(game=>{

const card=document.createElement('div');
card.className=isTrending?'game-card trending':'game-card';

card.innerHTML=`
<div class="game-thumbnail">${game.emoji||"üéÆ"}</div>
<div class="game-title">${game.title}</div>
<button class="play-btn">Spielen</button>
`;

card.querySelector('.play-btn').onclick=()=>showGameDetail(game);

container.appendChild(card);

});

}

function filterGames(){

const searchTerm=searchInput.value.toLowerCase();
const selectedCategory=document.querySelector('.category-filter:checked')?.value||'all';

filteredGames=games.filter(game=>{

const matchesSearch=game.title.toLowerCase().includes(searchTerm);
const matchesCategory=selectedCategory==='all'||game.category===selectedCategory;

return matchesSearch&&matchesCategory;

});

gameCount.textContent=`${filteredGames.length} Spiele`;

renderGames(filteredGames,gamesContainer);

}

function resetAllFilters(){

searchInput.value='';
document.querySelector('input[name="category"][value="all"]').checked=true;
sortFilter.value='newest';
filterGames();

}

</script>

};

// =====================
// SPIELE LADEN
// =====================

function loadGames(){

const container = document.getElementById("gamesContainer");

container.innerHTML = "";

games.forEach(game => {

const div = document.createElement("div");

div.className = "game-card";

div.innerHTML = `
<h3>${game.title}</h3>
<button class="play-btn">Spielen</button>
`;

div.onclick = () => openGame(game.url);

container.appendChild(div);

});

}

// =====================
// FILTER RESET (DEIN ALTER CODE)
// =====================

function resetAllFilters(){

searchInput.value='';
document.querySelector('input[name="category"][value="all"]').checked=true;
sortFilter.value='newest';
filterGames();

}

document.addEventListener("DOMContentLoaded", loadGames);

</script>
